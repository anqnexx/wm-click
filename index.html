<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clicker Game</title>
    <style>
        @font-face {
            font-family: 'FulboArgenta';
            src: url('fulbo-argenta.otf') format('opentype');
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'FulboArgenta', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #72e2ff, #d3d3ff);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }
        .counter {
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            color: black;
        }
        .coin-icon {
            width: 40px;
            height: 40px;
            margin-right: 10px;
            cursor: pointer; /* Сделать курсор указателем */
            transition: transform 0.2s; /* Анимация при наведении */
        }
        .coin-icon:hover {
            transform: scale(1.1); /* Увеличение при наведении */
        }
        #clickableImage {
            width: 200px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        #clickableImage:hover {
            transform: scale(1.1);
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background-color: rgba(144, 238, 144, 0.9);
            color: black;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            transition: left 0.3s ease;
            z-index: 1000;
        }
        .sidebar.open {
            left: 0;
        }
        .burger-button {
            cursor: pointer;
            font-size: 30px;
            position: absolute;
            top: 20px;
            left: 20px;
            transition: transform 0.3s ease;
        }
        .burger-button:hover {
            transform: scale(1.1);
        }
        .upgrade-list, .friends-list {
            margin-top: 20px;
            list-style-type: none;
            padding: 0;
        }
        .upgrade-item, .friend-item {
            margin: 10px 0;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            transition: background-color 0.3s ease;
        }
        .upgrade-item:hover, .friend-item:hover {
            background-color: #45a049;
        }
        .copy-link {
            display: inline-block;
            margin-top: 10px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        .particle {
            position: absolute;
            color: gold;
            font-size: 1.5rem;
            pointer-events: none;
            animation: fadeOut 1s forwards;
        }
        @keyframes fadeOut {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-30px);
            }
        }
        .username-display {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 20px;
            color: black;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="username-display" id="usernameDisplay"></div> <!-- Username display -->
        <div class="counter">
            <img src="coin.png" class="coin-icon" alt="Coin" id="coinIcon">
            <span id="coinCount">0</span>
        </div>
        <img id="clickableImage" src="tap.png" alt="Tap to earn coins">
        <div class="burger-button" onclick="toggleSidebar()">☰</div>
        <div class="sidebar" id="sidebar">
            <button class="upgrade-item" onclick="showUpgrades()">Upgrades</button>
            <button class="friend-item" onclick="showFriends()">Friends</button>
            <div id="upgrades" style="display: none;">
                <h3>Upgrades</h3>
                <ul class="upgrade-list" id="upgradeList"></ul>
            </div>
            <div id="friends" style="display: none;">
                <h3>Friends</h3>
                <ul class="friends-list" id="friendsList"></ul>
                <div class="copy-link" onclick="copyLink()">Copy referral link</div>
            </div>
        </div>
    </div>

    <script>
        let coinCount = 0;
        let clickUpgradeCost = 1000;
        let clickUpgradeValue = 1; // First upgrade +1 click
        let upgrades = [];
        let friends = [];
        let userId = Math.floor(Math.random() * 1000000); // Generate userId for example
        let referralLink = `https://t.me/watermelon_clickBOT_ref=${userId}`;
        let coinReceived = false; // Flag to check if coin has been received
        let username = ''; // Variable to hold the username

        function loadGame() {
            const savedCoins = localStorage.getItem('coinCount');
            const savedUpgrades = localStorage.getItem('upgrades');
            const savedFriends = localStorage.getItem('friends');
            const savedUsername = localStorage.getItem('username');

            if (savedCoins) {
                coinCount = parseInt(savedCoins);
            }
            if (savedUpgrades) {
                upgrades = JSON.parse(savedUpgrades);
            }
            if (savedFriends) {
                friends = JSON.parse(savedFriends);
            }
            if (savedUsername) {
                username = savedUsername;
            }

            updateDisplay();
            renderUpgrades();
            renderFriends();
            displayUsername();
        }

        function displayUsername() {
            const usernameDisplay = document.getElementById('usernameDisplay');
            if (isTelegramUser()) {
                username = prompt('Please enter your Telegram username:');
                localStorage.setItem('username', username);
            }
            usernameDisplay.innerText = username ? `Telegram User: @${username}` : '';
        }

        function isTelegramUser() {
            return navigator.userAgent.includes("Telegram");
        }

        function updateDisplay() {
            document.getElementById('coinCount').innerText = coinCount;
            localStorage.setItem('coinCount', coinCount);
        }

        function renderUpgrades() {
            const upgradeList = document.getElementById('upgradeList');
            upgradeList.innerHTML = '';
            upgrades.forEach((upgrade, index) => {
                upgradeList.innerHTML += `<li class="upgrade-item" onclick="buyUpgrade(${index})">${upgrade.name}: ${upgrade.cost} coins</li>`;
            });
            // Add click upgrade
            upgradeList.innerHTML += `<li class="upgrade-item" onclick="buyClickUpgrade()">Click Upgrade: ${clickUpgradeCost} coins</li>`;
        }

        function renderFriends() {
            const friendsList = document.getElementById('friendsList');
            friendsList.innerHTML = '';
            friends.forEach(friend => {
                friendsList.innerHTML += `<li class="friend-item">${friend.name}: ${friend.coins} coins</li>`;
            });
        }

        function buyClickUpgrade() {
            if (coinCount >= clickUpgradeCost) {
                coinCount -= clickUpgradeCost;
                clickUpgradeCost = Math.floor(clickUpgradeCost * 1.3);
                updateDisplay();
                alert('Click upgrade purchased! Now each click adds +1 coin.');
                renderUpgrades();
            } else {
                alert('Not enough coins to buy click upgrade!');
            }
        }

        function buyUpgrade(index) {
            if (coinCount >= upgrades[index].cost) {
                coinCount -= upgrades[index].cost;
                upgrades[index].cost = Math.floor(upgrades[index].cost * 1.5);
                updateDisplay();
                alert(`${upgrades[index].name} purchased!`);
                renderUpgrades();
            } else {
                alert('Not enough coins to buy this upgrade!');
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        function copyLink() {
            navigator.clipboard.writeText(referralLink);
            alert('Referral link copied to clipboard!');
        }

        document.getElementById('clickableImage').addEventListener('click', function () {
            coinCount += clickUpgradeValue;
            updateDisplay();
            createParticleEffect(event.pageX, event.pageY);
        });

        function createParticleEffect(x, y) {
            const particle = document.createElement('span');
            particle.className = 'particle';
            particle.innerText = '+1';
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            document.body.appendChild(particle);
            setTimeout(() => {
                particle.remove();
            }, 1000);
        }

        loadGame(); // Load saved game data when page loads
    </script>
</body>
</html>
